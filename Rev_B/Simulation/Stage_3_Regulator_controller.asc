Version 4
SHEET 1 4356 1996
WIRE 2976 -112 2944 -112
WIRE 2352 -32 2208 -32
WIRE 2944 -32 2944 -112
WIRE 2944 -32 2640 -32
WIRE 2944 -16 2944 -32
WIRE 1104 64 1056 64
WIRE 1152 64 1104 64
WIRE 1520 64 1440 64
WIRE 1648 64 1520 64
WIRE 1712 64 1648 64
WIRE 2352 64 1712 64
WIRE 2688 64 2640 64
WIRE 1520 80 1520 64
WIRE 2688 96 2688 64
WIRE 2944 96 2944 64
WIRE 2944 96 2688 96
WIRE 2736 128 2688 128
WIRE 1104 160 1104 64
WIRE 1152 160 1104 160
WIRE 1520 160 1440 160
WIRE 2352 160 2208 160
WIRE 2640 160 2624 160
WIRE 2688 160 2688 128
WIRE 2688 160 2640 160
WIRE 2864 160 2688 160
WIRE 1520 176 1520 160
WIRE 1648 176 1648 64
WIRE 2944 240 2944 224
WIRE 3040 240 2944 240
WIRE 3440 240 3040 240
WIRE 2352 256 2304 256
WIRE 2672 256 2640 256
WIRE 1296 304 1296 224
WIRE 1520 304 1520 256
WIRE 1520 304 1296 304
WIRE 1648 304 1648 240
WIRE 1648 304 1520 304
WIRE 2304 336 2304 256
WIRE 2352 336 2304 336
WIRE 3040 448 3040 240
WIRE 3584 496 3536 496
WIRE 3632 496 3584 496
WIRE 4000 496 3920 496
WIRE 4128 496 4000 496
WIRE 4192 496 4128 496
WIRE 4000 512 4000 496
WIRE 2672 592 2672 256
WIRE 2720 592 2672 592
WIRE 2832 592 2800 592
WIRE 3584 592 3584 496
WIRE 3632 592 3584 592
WIRE 4000 592 3920 592
WIRE 4000 608 4000 592
WIRE 4128 608 4128 496
WIRE 2672 624 2672 592
WIRE 2832 624 2832 592
WIRE 1296 736 1296 304
WIRE 1296 736 1248 736
WIRE 2208 736 2208 160
WIRE 2208 736 1296 736
WIRE 2672 736 2672 688
WIRE 2672 736 2208 736
WIRE 2832 736 2832 688
WIRE 2832 736 2672 736
WIRE 3040 736 3040 512
WIRE 3040 736 2832 736
WIRE 3776 736 3776 656
WIRE 3776 736 3040 736
WIRE 4000 736 4000 688
WIRE 4000 736 3776 736
WIRE 4128 736 4128 672
WIRE 4128 736 4000 736
WIRE 1520 1072 1376 1072
WIRE 1616 1072 1520 1072
WIRE 2544 1104 2496 1104
WIRE 2896 1104 2544 1104
WIRE 1376 1120 1376 1072
WIRE 1520 1136 1520 1072
WIRE 3616 1136 3568 1136
WIRE 2544 1168 2544 1104
WIRE 3616 1168 3616 1136
WIRE 2976 1200 2832 1200
WIRE 1520 1232 1520 1216
WIRE 1616 1232 1520 1232
WIRE 2896 1232 2896 1104
WIRE 1520 1248 1520 1232
WIRE 2832 1248 2832 1200
WIRE 2864 1248 2832 1248
WIRE 2976 1264 2976 1200
WIRE 2976 1264 2928 1264
WIRE 3072 1264 2976 1264
WIRE 2544 1280 2544 1248
WIRE 2752 1280 2544 1280
WIRE 2864 1280 2752 1280
WIRE 3616 1280 3616 1248
WIRE 3792 1280 3616 1280
WIRE 3808 1280 3792 1280
WIRE 1376 1296 1376 1200
WIRE 1376 1296 1328 1296
WIRE 1456 1296 1376 1296
WIRE 2544 1312 2544 1280
WIRE 3616 1312 3616 1280
WIRE 1376 1344 1376 1296
WIRE 3792 1344 3792 1280
WIRE 2544 1440 2544 1392
WIRE 2544 1440 2496 1440
WIRE 2896 1440 2896 1296
WIRE 2896 1440 2544 1440
WIRE 3616 1440 3616 1392
WIRE 3616 1440 3568 1440
WIRE 3792 1440 3792 1408
WIRE 3792 1440 3744 1440
WIRE 1376 1472 1376 1424
WIRE 1376 1472 1280 1472
WIRE 1520 1472 1520 1344
WIRE 1520 1472 1376 1472
FLAG 1056 64 Vboost
IOPIN 1056 64 In
FLAG 2352 336 FBX
IOPIN 2352 336 BiDir
FLAG 1248 736 GND
IOPIN 1248 736 In
FLAG 3440 240 Vout
IOPIN 3440 240 Out
FLAG 2736 128 Gate
IOPIN 2736 128 Out
FLAG 2976 -112 Vbuck
IOPIN 2976 -112 Out
FLAG 1328 1296 SHDN_N
IOPIN 1328 1296 In
FLAG 1616 1232 SHDN
FLAG 2208 -32 SHDN
FLAG 1712 64 P22V0
FLAG 2496 1440 GND
IOPIN 2496 1440 In
FLAG 3568 1136 Vout
IOPIN 3568 1136 In
FLAG 3808 1280 FBX
IOPIN 3808 1280 Out
FLAG 2496 1104 P3V3
FLAG 1616 1072 P22V0
FLAG 1280 1472 GND
IOPIN 1280 1472 In
FLAG 3072 1264 Vref_buf
FLAG 2752 1280 Vref
FLAG 3568 1440 Vref_buf
FLAG 3536 496 Vboost
IOPIN 3536 496 In
FLAG 4192 496 P3V3
FLAG 3744 1440 GND
IOPIN 3744 1440 In
SYMBOL cap 2656 624 R0
SYMATTR InstName C2
SYMATTR Value 10p
SYMBOL res 2704 608 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 7.5K
SYMBOL cap 2816 624 R0
SYMATTR InstName C3
SYMATTR Value 1000p
SYMBOL LT1575 2496 112 R0
SYMATTR InstName U1
SYMBOL My_NMOS 2960 160 R0
SYMATTR InstName X1
SYMBOL res 2928 -32 R0
SYMATTR InstName R4
SYMATTR Value 24m
SYMBOL My_capacitor 3040 496 R0
SYMATTR InstName X2
SYMBOL npn 1456 1248 R0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL res 1504 1120 R0
SYMATTR InstName R1
SYMATTR Value 5k
SYMBOL PowerProducts\\LT3012 1296 96 R0
SYMATTR InstName U2
SYMBOL res 1504 160 R0
SYMATTR InstName R5
SYMATTR Value 1.2k
SYMBOL res 1504 64 R0
SYMATTR InstName R6
SYMATTR Value 20.8k
SYMBOL res 1360 1104 R0
WINDOW 0 -40 42 Left 2
WINDOW 3 -64 69 Left 2
SYMATTR InstName R7
SYMATTR Value 4.3k
SYMBOL res 1360 1328 R0
WINDOW 0 -47 44 Left 2
WINDOW 3 -70 76 Left 2
SYMATTR InstName R8
SYMATTR Value 0.7k
SYMBOL res 2528 1152 R0
SYMATTR InstName R2
SYMATTR Value {Rfb_ref_top}
SYMBOL res 2528 1296 R0
SYMATTR InstName R9
SYMATTR Value {Rfb_ref}
SYMBOL res 3600 1152 R0
SYMATTR InstName R10
SYMATTR Value {Rfb}
SYMBOL res 3600 1296 R0
SYMATTR InstName R11
SYMATTR Value 500
SYMBOL OpAmps\\LT1677 2896 1200 R0
SYMATTR InstName U4
SYMBOL cap 1632 176 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL PowerProducts\\LT3012 3776 528 R0
SYMATTR InstName U3
SYMBOL res 3984 592 R0
SYMATTR InstName R15
SYMATTR Value 1.2k
SYMBOL res 3984 496 R0
SYMATTR InstName R16
SYMATTR Value 1.8k
SYMBOL cap 4112 608 R0
SYMATTR InstName C4
SYMATTR Value 10µ
SYMBOL cap 3776 1344 R0
SYMATTR InstName C5
SYMATTR Value 10µ
TEXT 3128 -176 Left 2 ;Rsense:\nIt limits the current such that there is a 50mV drop on Rsense. So if we limit\nthe current to 2.1 Amps the resistor should be ~24mOhms.
TEXT 2992 896 Left 2 ;Check the TI pdf on how to output voltages below 1.2V
TEXT 3136 -80 Left 2 ;Feedback comes from digial resistor module
TEXT 1592 -216 Left 2 ;Vin and Vpower have to come from different power supplies. \nThat way Vpower can follow Vout to voltages below 5V.\nThat way the voltage drop [and heat] is lowered
TEXT 2440 1496 Left 2 ;Digital Potentiometer
TEXT 3512 1496 Left 2 ;Digital Potentiometer
TEXT 2336 1704 Left 2 !.param Rfb_ref_top round(10000 - Rfb_ref)
TEXT 2336 1640 Left 2 !.param Vfb_ref_limit  min(3.3, max( 0.01, Vfb_ref))
TEXT 2336 1672 Left 2 !.param Rfb_ref round(10k * Vfb_ref_limit/ 3.3)
TEXT 3408 1696 Left 2 !.param Vwanted_limit min(25, max(1.2, Vwanted))
TEXT 3408 1728 Left 2 !.param Rfb max(1, round( 500 * ( Vwanted - Vrefint ) / (Vrefint - Vrefext)  ))
TEXT 2344 1752 Left 2 ;COMMENT: Just pass a value within 0V and Vref as param Vfb_ref
TEXT 3416 1760 Left 2 ;COMMENT: Just pass a value within 1.2V and 25V as param Vwanted
TEXT 1280 1616 Left 2 ;This is to stop leakage from the SHDN signal to Vpower.\nThe power going to the IC comes from P22V0_Vin\nMaking simulations better
TEXT 2336 1608 Left 2 !.param Rdigital 10k
TEXT 3408 1664 Left 2 !.param Vrefint=1.26 Vrefext=max(0.065, Vfb_ref)
RECTANGLE Normal 4352 1840 2272 864 2
